#!/usr/bin/env node

require('localenv');
require('babel-register');
const debug = require('debug')('localtunnel');

var argv = require('yargs')
    .usage('Usage: $0 --port [num] --max-sockets [num] --secure')
    .describe('port', 'Listening port')
    .describe('secure', 'Indicates communication with proxy should use HTTPS')
    .boolean('secure')
    .describe('max-sockets', 'Maximum number of sockets per Localtunnel client')
    .describe('host', 'Full domain of server, required if using a subdomain')
    .default('port', '8000')
    .default('max-sockets', 10)
    .help('h')
    .alias('h', 'help')
    .argv

const server = require('../server')(
{
    max_tcp_sockets: argv.maxSockets,
    secure: argv.secure,
    port: '8000',
    host: argv.host
    
});

server.listen(argv.port, () => {
    debug('server listening on port: %d', server.address().port);
});

process.on('SIGINT', () => {
    process.exit();
});

process.on('SIGTERM', () => {
    process.exit();
});

